(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41213260"],{"3a4c":function(t,e,r){},"7d0d":function(t,e,r){"use strict";var n=r("3a4c"),s=r.n(n);s.a},"99af":function(t,e,r){"use strict";var n=r("23e7"),s=r("d039"),i=r("e8b5"),a=r("861d"),o=r("7b0b"),c=r("50c4"),u=r("8418"),d=r("65f0"),l=r("1dde"),f=r("b622"),h=r("2d00"),v=f("isConcatSpreadable"),p=9007199254740991,m="Maximum allowed index exceeded",_=h>=51||!s((function(){var t=[];return t[v]=!1,t.concat()[0]!==t})),g=l("concat"),b=function(t){if(!a(t))return!1;var e=t[v];return void 0!==e?!!e:i(t)},y=!_||!g;n({target:"Array",proto:!0,forced:y},{concat:function(t){var e,r,n,s,i,a=o(this),l=d(a,0),f=0;for(e=-1,n=arguments.length;e<n;e++)if(i=-1===e?a:arguments[e],b(i)){if(s=c(i.length),f+s>p)throw TypeError(m);for(r=0;r<s;r++,f++)r in i&&u(l,f,i[r])}else{if(f>=p)throw TypeError(m);u(l,f++,i)}return l.length=f,l}})},db70:function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("ul",{staticClass:"user-order-menubar"},[r("li",{class:{"is-active":""===t.fetchQuery.status},on:{click:function(e){return t.changeStatus("")}}},[r("span",[t._v("全部")])]),r("li",{class:{"is-active":"pending"===t.fetchQuery.status},on:{click:function(e){return t.changeStatus("pending")}}},[r("span",[t._v("待付款")])]),r("li",{class:{"is-active":"processing"===t.fetchQuery.status},on:{click:function(e){return t.changeStatus("processing")}}},[r("span",[t._v("待发货")])]),r("li",{class:{"is-active":"sent"===t.fetchQuery.status},on:{click:function(e){return t.changeStatus("sent")}}},[r("span",[t._v("待收货")])]),r("li",{class:{"is-active":"refunding"===t.fetchQuery.status},on:{click:function(e){return t.changeStatus("refunding")}}},[r("span",[t._v("退换货")])])]),r("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.getOrders,expression:"getOrders"}],staticClass:"order-list",style:{height:t.height-1+"px"},attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"10","infinite-scroll-immediate-check":""}},[t._l(t.orders,(function(e,n){return r("li",{key:n,staticClass:"order-list-item"},[r("div",{staticClass:"order-list-item__title",on:{click:function(r){return t.toCheck(e)}}},[r("div",[t._v(t._s(e.created_at))]),r("div",{class:{"is-disabled":-1!==t.disabledStatus.indexOf(e.status)}},[t._v(t._s(e.status_value))])]),t._l(e.items,(function(e,n){return r("div",{key:"i"+n,staticClass:"order-list-item__item"},[r("div",[r("shop-image",{staticClass:"order-list-item__item-image",attrs:{src:e.img_url,type:"fit",width:60,rounded:""}},[r("div",{staticClass:"order-item-placeholder",attrs:{slot:"error"},slot:"error"}),r("div",{staticClass:"order-item-placeholder",attrs:{slot:"placeholder"},slot:"placeholder"})])],1),r("div",{staticClass:"order-list-item__item-title"},[r("div",[t._v(t._s(e.product_title))]),r("div",[t._v(t._s(e.variant_title))])]),r("div",{staticClass:"order-list-item__item-price"},[r("div",[t._v("¥ "),r("strong",[t._v(t._s(e.price))])]),r("div",[t._v("x "+t._s(e.quantity))])])])})),r("div",{staticClass:"order-list-item__bottom"},[r("div",[t._v("订单总额 ¥ "),r("strong",[t._v(t._s(e.amount?e.amount:"-"))])]),r("div",[-1!==t.canClose.indexOf(e.status)?r("shop-button",{attrs:{size:"small",type:"border"},on:{click:function(r){return t.toClose(e)}}},[t._v("关闭订单")]):t._e(),-1!==t.canShip.indexOf(e.status)?r("shop-button",{attrs:{size:"small",type:"border"}},[t._v("查看物流")]):t._e(),-1!==t.canRefund.indexOf(e.status)?r("shop-button",{attrs:{size:"small",type:"border"}},[t._v("退换货")]):t._e(),-1!==t.canReceive.indexOf(e.status)?r("shop-button",{attrs:{size:"small"}},[t._v("确认收货")]):t._e()],1)])],2)})),t.nomore?t._e():r("div",{staticClass:"order-list-placeholder"},[t._v("加载中...")]),t.nomore?r("div",{staticClass:"order-list-placeholder"},[t._v("没有更多了")]):t._e()],2)])},s=[],i=(r("99af"),r("b0c0"),r("f8b7")),a=r("76a0"),o={data:function(){return{fetchQuery:{status:void 0!==this.$route.params.status?this.$route.params.status:"",page:0,pageSize:15},loading:!1,nomore:!1,height:0,orders:[],canClose:["pending"],canShip:["sent","partial","success"],canRefund:["processing","sent","partial","success"],canReceive:["sent","partial"],disabledStatus:["cancel","closed","refunded"]}},mounted:function(){var t=this;this.$nextTick((function(){t.height=window.innerHeight-170}))},beforeRouteLeave:function(t,e,r){"UserOrderDetail"===t.name?e.meta.keepAlive=!0:e.meta.keepAlive=!1,r()},methods:{getOrders:function(){var t=this;this.loading=!0,this.nomore=!1,this.fetchQuery.page+=1,Object(i["f"])(this.fetchQuery).then((function(e){var r=e.data.body.data;0===r.length?(t.loading=!0,t.nomore=!0):(t.loading=!1,t.nomore=!1,t.orders=t.orders.concat(r))})).catch((function(e){t.loading=!0,t.nomore=!0,401===e.response.status&&(Object(a["Toast"])("登录超时"),t.$router.push({name:"Login",query:{from:t.$route.name}}))}))},changeStatus:function(t){this.fetchQuery.status=t,this.fetchQuery.page=0,this.orders=[],this.loading=!1,this.nomore=!1,this.getOrders()},toCheck:function(t){this.$router.push({name:"UserOrderDetail",query:{no:t.no}})},toClose:function(t){var e=this;a["MessageBox"].confirm("是否确认关闭?").then((function(){Object(i["b"])(t.no,{status:"cancel"}).then((function(){Object(a["Toast"])("订单已关闭"),e.fetchQuery.page=0,e.orders=[],e.loading=!1,e.nomore=!1,e.getOrders()}))})).catch((function(){}))}}},c=o,u=(r("7d0d"),r("2877")),d=Object(u["a"])(c,n,s,!1,null,"043a4dda",null);e["default"]=d.exports},f8b7:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"c",(function(){return i})),r.d(e,"d",(function(){return a})),r.d(e,"g",(function(){return o})),r.d(e,"f",(function(){return c})),r.d(e,"e",(function(){return u})),r.d(e,"b",(function(){return d}));var n=r("b775");function s(t){return Object(n["a"])({url:"order/calc",method:"post",data:t})}function i(t){return Object(n["a"])({url:"order",method:"post",data:t})}function a(t,e){return Object(n["a"])({url:"order/"+t+"/pay/"+e,method:"post"})}function o(t){return Object(n["a"])({url:"pay/"+t+"/wallet",method:"get"})}function c(t){return Object(n["a"])({url:"order",method:"get",params:t})}function u(t){return Object(n["a"])({url:"order/"+t,method:"get"})}function d(t,e){return Object(n["a"])({url:"order/"+t,method:"put",data:e})}}}]);