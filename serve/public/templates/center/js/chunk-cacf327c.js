(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cacf327c"],{"0776":function(t,e,i){t.exports=i.p+"templates/center/img/balloon_two_color.png"},"12de":function(t,e,i){"use strict";i.d(e,"c",(function(){return n})),i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return o}));var s=i("b775");function n(){return Object(s["a"])({url:"shop/template",method:"get"})}function a(t){return Object(s["a"])({url:"shop/template/"+t,method:"get"})}function o(t,e){return Object(s["a"])({url:"shop/template/"+e,method:"put",data:t})}},1832:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"web-container"},[s("div",{staticClass:"web-header"},[t._v(" 商城配置 "),s("div",{staticClass:"back-button",on:{click:t.returnCenter}},[t._v("回到主控台")])]),s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"back-content"},[1===t.activeIndex?s("set-basic",{attrs:{shop:t.shop,btnLoading:t.btnLoading},on:{confirm:t.editBasic,next:t.toNext}}):t._e(),2===t.activeIndex?s("set-theme",{attrs:{activeIndex:t.activeIndex,shop:t.shop,btnLoading:t.btnLoading},on:{confirm:t.confirmTheme,prev:t.toPrev,complete:t.confirm}}):t._e(),4===t.activeIndex?s("div",[t.isComplete?t._e():s("div",[t._m(0),s("div",{staticClass:"image-tip-text"},[t._v("安装中...")])]),s("transition",{attrs:{name:"success"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.isComplete,expression:"isComplete"}],staticClass:"setup-success"},[s("div",{staticClass:"image-tip"},[s("img",{attrs:{src:i("bd25")}})]),s("div",{staticClass:"image-tip-text"},[t._v("安装成功")])])]),t.isComplete?s("div",{staticStyle:{"text-align":"center","margin-top":"40px"}},[s("el-button",{attrs:{type:"primary"},on:{click:t.returnCenter}},[t._v("回到商城列表")]),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.$router.push({name:"Dashboard"})}}},[t._v("进入商城")])],1):t._e()],1):t._e()],1)])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"image-tip image-tip-floating"},[s("img",{attrs:{src:i("0776")}})])}],a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"set-title"},[t._v("商城基础设置")]),s("div",{staticClass:"set-image",style:{height:t.height+"px"}},[s("img",{attrs:{src:i("b2f2")}})]),s("div",{staticClass:"set-form"},[s("div",{staticClass:"set-form-item"},[s("div",[t._v("商城名称")]),s("div",[s("el-input",{model:{value:t.shop.shop_name,callback:function(e){t.$set(t.shop,"shop_name",e)},expression:"shop.shop_name"}})],1)]),s("div",{staticClass:"set-form-item"},[s("div",[t._v("域名地址")]),s("div",[s("el-input",{attrs:{disabled:"免费版"===t.shop.shop_level},model:{value:t.shop.shop_url,callback:function(e){t.$set(t.shop,"shop_url",e)},expression:"shop.shop_url"}},[s("span",{attrs:{slot:"append"},slot:"append"},[t._v("."+t._s(t.shop.shop_host))])]),"免费版"===t.shop.shop_level?s("div",{staticClass:"set-tip"},[t._v("免费版域名地址自动生成，如需自定义域名地址，可在商城后台中升级")]):t._e()],1)]),s("div",{staticClass:"set-form-button"},[s("el-button",{attrs:{type:"primary",loading:t.btnLoading},on:{click:t.confirm}},[t._v("保存")]),s("el-button",{attrs:{type:"primary"},on:{click:t.toNext}},[t._v("下一步")])],1)])])},o=[],r={props:{shop:Object,btnLoading:Boolean},data:function(){return{height:0}},mounted:function(){var t=this;this.$nextTick((function(){window.innerHeight-482>100?t.height=window.innerHeight-482:t.height=100})),window.onresize=function(){window.innerHeight-482>100?t.height=window.innerHeight-482:t.height=100}},methods:{confirm:function(){this.$emit("confirm")},toNext:function(){this.$emit("next")}}},c=r,l=(i("55ce"),i("2877")),h=Object(l["a"])(c,a,o,!1,null,"74abe158",null),p=h.exports,d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"set-title"},[t._v("主题选择")]),void 0!==t.current_theme.template_id?i("div",{staticClass:"current-theme"},[t._v("当前主题："),i("strong",[t._v(t._s(t.current_theme.template_name))])]):t._e(),i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"set-theme-list",style:{height:t.height+"px"}},t._l(t.themes,(function(e,s){return i("el-radio",{key:s,staticClass:"theme-items",attrs:{label:e,disabled:e.hasTheme},model:{value:t.selected_theme,callback:function(e){t.selected_theme=e},expression:"selected_theme"}},[i("div",[i("div",{staticClass:"theme-title"},[t._v("主题"+t._s(s+1)+"："),i("strong",[t._v(t._s(e.template_name))])]),i("div",{staticClass:"theme-image"},[i("el-image",{staticStyle:{width:"200px"},attrs:{fit:"contain",src:e.template_img}})],1),e.template_content?i("div",[t._v("适用场景："+t._s(e.template_content))]):t._e(),i("div",[i("span",[t._v("购买时长")]),i("el-select",{staticStyle:{width:"154px","margin-left":"10px"},attrs:{disabled:e.hasTheme},on:{change:function(i){return t.changeVariant(e)}},model:{value:e.current_variant_id,callback:function(i){t.$set(e,"current_variant_id",i)},expression:"theme.current_variant_id"}},t._l(e.variants,(function(t,e){return i("el-option",{key:"v"+e,attrs:{value:t.variant_id,label:t.time+"个月"}})})),1)],1),i("div",{staticClass:"theme-price"},[t._v("价格：¥ "),i("strong",[t._v(t._s(e.current_price))])])])])})),1),i("div",{staticClass:"payment-list"},[i("span",{staticStyle:{"margin-right":"10px"}},[t._v("支付方式：")]),i("el-radio-group",{attrs:{size:"small",disabled:t.themes.filter((function(t){return t.hasTheme})).length===t.themes.length},model:{value:t.payment_method,callback:function(e){t.payment_method=e},expression:"payment_method"}},t._l(t.payments,(function(e,s){return i("el-radio-button",{key:s,attrs:{label:e.method_code}},[t._v(t._s(e.method_title))])})),1)],1),i("div",{staticClass:"set-form-button"},[i("el-button",{attrs:{type:"primary"},on:{click:t.toPrev}},[t._v("上一步")]),i("el-button",{attrs:{type:"primary",disabled:t.themes.filter((function(t){return t.hasTheme})).length===t.themes.length},on:{click:t.toPay}},[t._v("保存")]),i("el-button",{attrs:{type:"primary"},on:{click:t.toComplete}},[t._v("完成设置")])],1),i("pay-dialog",{attrs:{Visible:t.payVisible,Title:t.payTitle,payment:t.payment_method,gotUrl:t.gotUrl,url:t.url},on:{close:t.closePay}})],1)},m=[],u=(i("4de4"),i("d81d"),i("a9e3"),i("12de")),_=i("e692"),v=i("825f"),g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{visible:t.Visible,title:t.Title,width:"400px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1}},[t.gotUrl?t._e():i("div",{staticStyle:{"text-align":"center"}},[i("i",{staticClass:"el-icon-loading",staticStyle:{"margin-right":"5px","font-size":"20px"}}),t._v("正在获取二维码")]),t.gotUrl?i("div",[i("div",[t._v("请打开"+t._s("alipay"===t.payment?"支付宝":"微信")+"，扫描下方二维码进行付款")]),i("div",[t.gorUrl?i("iframe",{attrs:{src:t.url,width:"210",height:"220"}}):t._e()])]):t._e(),i("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.close}},[t._v("取消付款")])],1)])},f=[],b={props:{Visible:Boolean,Title:String,gotUrl:Boolean,payment:String,url:String},methods:{close:function(){this.$emit("close")}}},y=b,x=Object(l["a"])(y,g,f,!1,null,null,null),w=x.exports,C={components:{PayDialog:w},props:{shop:Object,activeIndex:Number},data:function(){return{loading:!1,themes:[],height:0,selected_theme:{},selected_variant_id:"",payments:[],payment_method:"",payVisible:!1,payTitle:"",gotUrl:!1,url:"",current_theme:{}}},mounted:function(){var t=this;this.$nextTick((function(){t.height=window.innerHeight-377})),window.onresize=function(){t.height=window.innerHeight-377}},methods:{getThemes:function(){var t=this;this.loading=!0,Object(u["c"])().then((function(e){t.current_theme=e.data.body.filter((function(t){return t.active}))[0];var i=e.data.body;t.getPayments(),Object(_["d"])().then((function(e){t.themes=e.data.body,t.themes.map((function(t){t["current_variant_id"]=t.variants[0].variant_id,t["current_price"]=t.variants[0].price,0!==i.filter((function(e){return e.template_id===t.template_id})).length?t["hasTheme"]=!0:t["hasTheme"]=!1})),t.selected_theme=t.themes[0],t.selected_variant_id=t.themes[0].variants[0].variant_id,t.loading=!1})).catch((function(){t.loading=!1}))})).catch((function(){t.loading=!1}))},getPayments:function(){var t=this;Object(v["b"])().then((function(e){t.payments=e.data.body,t.payment_method=t.payments[0].method_code}))},changeVariant:function(t){t.current_price=t.variants.filter((function(e){return e.variant_id===t.current_variant_id}))[0].price,this.selected_variant_id=t.current_variant_id},toPrev:function(){this.$emit("prev")},toComplete:function(){this.$emit("complete")},toPay:function(){var t=this,e={shop_id:this.$store.getters.shop_id,payment_method:this.payment_method,item:{type:"template",item_id:this.selected_variant_id}};Object(v["a"])(e).then((function(){"免费版"===t.$store.getters.shop_level?t.confirm():(t.payTitle="alipay"===t.payment_method?"支付宝支付":"微信支付",t.payVisible=!0)}))},closePay:function(){this.payVisible=!1,this.gotUrl=!1,this.url="",this.payTitle=""},confirm:function(){this.$emit("confirm")}},watch:{activeIndex:{deep:!0,immediate:!0,handler:function(){2===this.activeIndex&&this.getThemes()}}}},$=C,k=(i("4588"),i("f06a"),Object(l["a"])($,d,m,!1,null,"480bdcbe",null)),T=k.exports,j={components:{SetBasic:p,SetTheme:T},data:function(){return{activeIndex:1,loading:!1,shop:{shop_name:"",shop_level:"",shop_url:"",shop_status:"",shop_id:"",shop_active:"",shop_host:"",shop_exp:""},btnLoading:!1,isComplete:!1}},created:function(){this.loading=!0},methods:{toPrev:function(){this.activeIndex-=1},toNext:function(){this.activeIndex+=1},editBasic:function(){var t=this;this.btnLoading=!0;var e={shop_name:this.shop.shop_name,shop_url:this.shop.shop_url};Object(_["a"])(e).then((function(){t.activeIndex=2,t.btnLoading=!1})).catch((function(){t.btnLoading=!1}))},confirmTheme:function(){this.$message.success("创建主题成功"),this.activeIndex=3},confirm:function(){var t=this;this.activeIndex=4,Object(_["a"])({status:"active"}).then((function(){setTimeout((function(){t.isComplete=!0}),5e3)})).catch((function(e){t.activeIndex=3,t.$message.error(e.response.data.message)}))},returnCenter:function(){}},watch:{"$store.getters.shop_status":{handler:function(t){""!==t&&(this.loading=!1,this.shop.shop_name=this.$store.getters.shop_name,this.shop.shop_level=this.$store.getters.shop_level,this.shop.shop_url=this.$store.getters.shop_url,this.shop.shop_id=this.$store.getters.shop_id,this.shop.shop_status=this.$store.getters.shop_status,this.shop.shop_host=this.$store.getters.shop_host,this.shop.shop_active=this.$store.getters.shop_active,this.shop.shop_exp=this.$store.getters.shop_exp),this.shop.shop_active&&this.$router.push({name:"Dashboard"})}}}},I=j,O=(i("5457"),Object(l["a"])(I,s,n,!1,null,"6e862b1a",null));e["default"]=O.exports},"3301e":function(t,e,i){},4588:function(t,e,i){"use strict";var s=i("7251"),n=i.n(s);n.a},5457:function(t,e,i){"use strict";var s=i("3301e"),n=i.n(s);n.a},"55ce":function(t,e,i){"use strict";var s=i("d255"),n=i.n(s);n.a},7251:function(t,e,i){},ace0:function(t,e,i){},b2f2:function(t,e,i){t.exports=i.p+"templates/center/img/marginalia-online-shopping.png"},bd25:function(t,e,i){t.exports=i.p+"templates/center/img/shopping.png"},d255:function(t,e,i){},f06a:function(t,e,i){"use strict";var s=i("ace0"),n=i.n(s);n.a}}]);